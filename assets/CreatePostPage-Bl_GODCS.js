import{d as M,u as S,r as n,y as T,a as i,b as e,q as U,i as p,f as b,v as k,p as g,t as d,j as B,k as q,B as D,m as j,w as A,h as H,n as I,x as L,s as l}from"./index-BahtY7yE.js";import{u as R}from"./Post-Baz_lnpz.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"container"},F={class:"row justify-content-center"},K={class:"col-md-8"},W={class:"card shadow"},$={class:"card-body"},G={class:"mb-3"},J={key:0,class:"invalid-feedback"},O={class:"mb-3"},Q={key:0,class:"invalid-feedback"},X={class:"mb-3"},Y={class:"d-flex align-items-center mb-2"},Z=["src"],tt={key:1,class:"rounded me-3 bg-light d-flex align-items-center justify-content-center",style:{width:"120px",height:"80px"}},et={key:0,class:"invalid-feedback"},at={class:"mb-3"},ot={key:0,class:"invalid-feedback"},st={class:"mb-3"},it={class:"form-check"},lt={class:"d-grid gap-2"},nt=["disabled"],rt=M({__name:"CreatePostPage",setup(dt){const x=L(),V=R(),r=S(),c=n(""),u=n(""),v=n(""),m=n(""),y=n(!1),f=n(!1),a=T({title:"",content:"",category:"",image:""}),w=o=>{var s;const t=(s=o.target.files)==null?void 0:s[0];if(!t)return;if(t.size>5*1024*1024){a.image="Kích thước file không được vượt quá 5MB";return}if(!t.type.startsWith("image/")){a.image="Vui lòng chọn file ảnh";return}a.image="";const h=new FileReader;h.onload=N=>{var _;m.value=(_=N.target)==null?void 0:_.result},h.readAsDataURL(t)},C=()=>{let o=!0;return a.title="",a.content="",a.category="",a.image="",c.value.trim().length<5&&(a.title="Tiêu đề phải có ít nhất 5 ký tự",o=!1),u.value.trim().length<50&&(a.content="Nội dung phải có ít nhất 50 ký tự",o=!1),v.value||(a.category="Vui lòng chọn danh mục",o=!1),o},P=async()=>{if(C()){if(!r.isAuthenticated||!r.user){alert("Vui lòng đăng nhập để tạo bài viết"),x.push({name:"Login"});return}try{f.value=!0;const o={title:c.value.trim(),content:u.value.trim(),category:v.value,image:m.value||"https://picsum.photos/600/400?random="+Math.random(),authorId:r.user.id||1,authorName:r.user.name,authorAvatar:r.user.avatar,featured:y.value},t=V.addPost(o);alert("Tạo bài viết thành công!"),window.location.href=`/#/post/${t.id}`}catch(o){console.error("Error creating post:",o),alert("Có lỗi xảy ra khi tạo bài viết. Vui lòng thử lại.")}finally{f.value=!1}}};return(o,t)=>{const h=I("router-link");return l(),i("div",E,[e("div",F,[e("div",K,[e("div",W,[e("div",$,[t[13]||(t[13]=e("h2",{class:"text-center mb-4"},"Tạo bài viết mới",-1)),e("form",{onSubmit:U(P,["prevent"])},[e("div",G,[t[4]||(t[4]=e("label",{class:"form-label"},"Tiêu đề bài viết",-1)),p(e("input",{type:"text",class:g(["form-control",{"is-invalid":a.title}]),"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),required:"",placeholder:"Nhập tiêu đề bài viết..."},null,2),[[k,c.value]]),a.title?(l(),i("div",J,d(a.title),1)):b("",!0)]),e("div",O,[t[6]||(t[6]=e("label",{class:"form-label"},"Danh mục",-1)),p(e("select",{class:g(["form-select",{"is-invalid":a.category}]),"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),required:""},t[5]||(t[5]=[q('<option value="" data-v-3fdb0ea9>Chọn danh mục</option><option value="technology" data-v-3fdb0ea9>Công nghệ</option><option value="lifestyle" data-v-3fdb0ea9>Lối sống</option><option value="travel" data-v-3fdb0ea9>Du lịch</option><option value="food" data-v-3fdb0ea9>Ẩm thực</option>',5)]),2),[[B,v.value]]),a.category?(l(),i("div",Q,d(a.category),1)):b("",!0)]),e("div",X,[t[8]||(t[8]=e("label",{class:"form-label"},"Hình ảnh bài viết",-1)),e("div",Y,[m.value?(l(),i("img",{key:0,src:m.value,class:"rounded me-3",style:{width:"120px",height:"80px","object-fit":"cover"}},null,8,Z)):(l(),i("div",tt,t[7]||(t[7]=[e("i",{class:"bi bi-image"},null,-1)])))]),e("input",{type:"file",class:g(["form-control",{"is-invalid":a.image}]),accept:"image/*",onChange:w},null,34),a.image?(l(),i("div",et,d(a.image),1)):b("",!0),t[9]||(t[9]=e("small",{class:"text-muted"},"Upload hình ảnh cho bài viết (tối đa 5MB)",-1))]),e("div",at,[t[10]||(t[10]=e("label",{class:"form-label"},"Nội dung bài viết",-1)),p(e("textarea",{class:g(["form-control",{"is-invalid":a.content}]),"onUpdate:modelValue":t[2]||(t[2]=s=>u.value=s),rows:"8",required:"",placeholder:"Viết nội dung bài viết của bạn..."},null,2),[[k,u.value]]),a.content?(l(),i("div",ot,d(a.content),1)):b("",!0)]),e("div",st,[e("div",it,[p(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>y.value=s),id:"featuredCheck"},null,512),[[D,y.value]]),t[11]||(t[11]=e("label",{class:"form-check-label",for:"featuredCheck"}," Đánh dấu là bài viết nổi bật ",-1))])]),e("div",lt,[e("button",{type:"submit",class:"btn btn-primary",disabled:f.value},d(f.value?"Đang tạo bài viết...":"Tạo bài viết"),9,nt),j(h,{to:{name:"Home"},class:"btn btn-outline-secondary"},{default:A(()=>t[12]||(t[12]=[H(" Hủy bỏ ")])),_:1,__:[12]})])],32)])])])])])}}}),mt=z(rt,[["__scopeId","data-v-3fdb0ea9"]]);export{mt as default};
