import{D as d,E as l}from"./index-BahtY7yE.js";const p=d("post",{state:()=>({posts:[],currentPage:1,postsPerPage:6,searchQuery:"",selectedCategory:"",sortBy:"newest"}),getters:{filteredPosts:e=>{let t=[...e.posts];switch(e.searchQuery&&(t=t.filter(s=>s.title.toLowerCase().includes(e.searchQuery.toLowerCase())||s.content.toLowerCase().includes(e.searchQuery.toLowerCase()))),e.selectedCategory&&(t=t.filter(s=>s.category===e.selectedCategory)),e.sortBy){case"newest":t.sort((s,r)=>r.createdAt-s.createdAt);break;case"oldest":t.sort((s,r)=>s.createdAt-r.createdAt);break;case"views":t.sort((s,r)=>(r.views||0)-(s.views||0));break;case"comments":t.sort((s,r)=>{var o,i;return(((o=r.comments)==null?void 0:o.length)||0)-(((i=s.comments)==null?void 0:i.length)||0)});break;case"likes":t.sort((s,r)=>{var o,i;return(((o=r.likes)==null?void 0:o.length)||0)-(((i=s.likes)==null?void 0:i.length)||0)});break}return t},paginatedPosts:e=>{let t=[...e.posts];switch(e.searchQuery&&(t=t.filter(o=>o.title.toLowerCase().includes(e.searchQuery.toLowerCase())||o.content.toLowerCase().includes(e.searchQuery.toLowerCase()))),e.selectedCategory&&(t=t.filter(o=>o.category===e.selectedCategory)),e.sortBy){case"newest":t.sort((o,i)=>i.createdAt-o.createdAt);break;case"oldest":t.sort((o,i)=>o.createdAt-i.createdAt);break;case"views":t.sort((o,i)=>(i.views||0)-(o.views||0));break;case"comments":t.sort((o,i)=>{var n,a;return(((n=i.comments)==null?void 0:n.length)||0)-(((a=o.comments)==null?void 0:a.length)||0)});break;case"likes":t.sort((o,i)=>{var n,a;return(((n=i.likes)==null?void 0:n.length)||0)-(((a=o.likes)==null?void 0:a.length)||0)});break}const s=(e.currentPage-1)*e.postsPerPage,r=s+e.postsPerPage;return t.slice(s,r)},totalPages:e=>{let t=[...e.posts];return e.searchQuery&&(t=t.filter(s=>s.title.toLowerCase().includes(e.searchQuery.toLowerCase())||s.content.toLowerCase().includes(e.searchQuery.toLowerCase()))),e.selectedCategory&&(t=t.filter(s=>s.category===e.selectedCategory)),Math.ceil(t.length/e.postsPerPage)},popularPosts:e=>[...e.posts].sort((t,s)=>(s.views||0)-(t.views||0)).slice(0,3),featuredPosts:e=>e.posts.filter(t=>t.featured)},actions:{loadPosts(){const e=localStorage.getItem("posts");e?this.posts=JSON.parse(e):(this.posts=[{id:1,title:"Hướng dẫn học Vue.js cho người mới bắt đầu",content:"Vue.js là một framework JavaScript tiến bộ để xây dựng giao diện người dùng. Trong bài viết này, chúng ta sẽ tìm hiểu những kiến thức cơ bản về Vue.js...",category:"technology",image:"https://picsum.photos/600/400?random=1",authorId:1,authorName:"Admin",authorAvatar:"https://i.pravatar.cc/150?img=1",createdAt:Date.now()-864e5,views:120,likes:[1,2],featured:!0,status:"published",comments:[]},{id:2,title:"10 địa điểm du lịch đẹp nhất Việt Nam",content:"Việt Nam là một đất nước có nhiều cảnh đẹp thiên nhiên và di tích lịch sử. Hãy cùng khám phá 10 địa điểm du lịch đẹp nhất...",category:"travel",image:"https://picsum.photos/600/400?random=2",authorId:1,authorName:"Admin",authorAvatar:"https://i.pravatar.cc/150?img=1",createdAt:Date.now()-1728e5,views:85,likes:[1],featured:!1,status:"published",comments:[]}],this.savePosts())},savePosts(){localStorage.setItem("posts",JSON.stringify(this.posts))},addPost(e){const t={id:Date.now(),...e,createdAt:Date.now(),views:0,likes:[],comments:[],status:"published",featured:e.featured||!1};return this.posts.unshift(t),this.savePosts(),t},updatePost(e,t){const s=this.posts.findIndex(r=>r.id===e);s!==-1&&(this.posts[s]={...this.posts[s],...t,updatedAt:Date.now()},this.savePosts())},deletePost(e){this.posts=this.posts.filter(t=>t.id!==e),this.savePosts()},getPost(e){return this.posts.find(t=>t.id===parseInt(e.toString()))},incrementViews(e){const t=this.posts.find(s=>s.id===e);t&&(t.views=(t.views||0)+1,this.savePosts())},toggleLike(e,t){const s=this.posts.find(o=>o.id===e);if(!s)return;s.likes||(s.likes=[]);const r=s.likes.findIndex(o=>o===t);r===-1?s.likes.push(t):s.likes.splice(r,1),this.savePosts()},addComment(e,t,s,r,o){const i=this.posts.find(a=>a.id===e);if(!i)return;i.comments||(i.comments=[]);const n={id:Date.now(),content:t,authorId:s,authorName:r,authorAvatar:o||"https://via.placeholder.com/32",createdAt:Date.now(),replies:[]};return i.comments.push(n),this.savePosts(),i.authorId!==s&&l().notifyNewComment(e,i.title,r),n},addReply(e,t,s,r,o,i){const n=this.posts.find(c=>c.id===e);if(!n)return;const a=n.comments.find(c=>c.id===t);if(!a)return;a.replies||(a.replies=[]);const h={id:Date.now(),content:s,authorId:r,authorName:o,authorAvatar:i||"https://via.placeholder.com/32",createdAt:Date.now()};return a.replies.push(h),this.savePosts(),h},deleteComment(e,t){const s=this.posts.find(r=>r.id===e);s&&(s.comments=s.comments.filter(r=>r.id!==t),this.savePosts())},getUserPosts(e){return this.posts.filter(t=>t.authorId===e)},setPagination(e,t){this.currentPage=e,this.postsPerPage=t},setSearch(e){this.searchQuery=e,this.currentPage=1},setCategory(e){this.selectedCategory=e,this.currentPage=1},setSortBy(e){this.sortBy=e,this.currentPage=1}}});export{p as u};
